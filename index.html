<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Love Animation ‚Äî Bucin Mode</title>
  <style>
    /* ---------- base reset ---------- */
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{
      min-height:100vh;
      background:#000;
      font-family:'Arial Black',sans-serif;
      position:relative;
      overflow:hidden;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      transition:background 0.6s ease;
    }

    /* ---------- background gradients & rays ---------- */
    .bg-gradient{
      position:fixed;inset:0;z-index:0;
      background:linear-gradient(135deg,#667eea 0%,#764ba2 50%,#f093fb 100%);
      animation:bgShift 12s ease-in-out infinite;
      opacity:.85;filter:blur(8px);
      transform-origin:center;
    }
    @keyframes bgShift{
      0%,100%{filter:blur(8px);background:linear-gradient(135deg,#667eea 0%,#764ba2 50%,#f093fb 100%)}
      50%{filter:blur(6px);background:linear-gradient(135deg,#f093fb 0%,#f5576c 50%,#667eea 100%)}
    }
    .light-ray{position:fixed;inset:0;pointer-events:none;background:radial-gradient(circle at 30% 20%, rgba(255,20,147,0.12), transparent 25%), radial-gradient(circle at 70% 80%, rgba(255,105,180,0.08), transparent 30%);z-index:1}

    /* ---------- main container ---------- */
    .container{position:relative;z-index:10;display:flex;flex-direction:column;align-items:center;gap:40px;padding:40px 20px}

    /* ---------- heart / 3d / pulse ---------- */
    .heart-container{position:relative;width:420px;height:420px;perspective:1000px}
    .heart-3d{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:280px;height:280px;animation:float3d 5s ease-in-out infinite;transform-style:preserve-3d}
    @keyframes float3d{0%,100%{transform:translate(-50%,-50%) rotateY(0) scale(1)}25%{transform:translate(-50%,-45%) rotateY(90deg) scale(1.05)}50%{transform:translate(-50%,-50%) rotateY(180deg) scale(1)}75%{transform:translate(-50%,-45%) rotateY(270deg) scale(1.05)}}

    .main-heart{position:relative;width:280px;height:280px;filter:drop-shadow(0 0 60px rgba(255,20,147,.9));transform-origin:center center;animation:heartbeat 1.2s ease-in-out infinite}
    .main-heart::before,.main-heart::after{content:"";position:absolute;top:0;width:140px;height:220px;background:linear-gradient(135deg,#ff1493 0%,#ff69b4 50%,#ff8fab 100%);border-radius:140px 140px 0 0}
    .main-heart::before{left:70px;transform:rotate(-45deg);transform-origin:0 100%}
    .main-heart::after{left:0;transform:rotate(45deg);transform-origin:100% 100%}
    @keyframes heartbeat{0%,100%{transform:scale(1)}14%{transform:scale(1.25)}28%{transform:scale(1)}42%{transform:scale(1.25)}70%{transform:scale(1)}}

    /* energy rings */
    .energy-ring{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);border-radius:50%;border:3px solid rgba(255,20,147,.35);animation:energyExpand 2.2s ease-out infinite}
    .energy-ring.r2{border-color:rgba(255,105,180,.28);animation-delay:.45s}
    .energy-ring.r3{border-color:rgba(255,182,193,.22);animation-delay:.9s}
    .energy-ring.r4{border-color:rgba(186,85,211,.2);animation-delay:1.35s}
    @keyframes energyExpand{0%{width:280px;height:280px;opacity:1}100%{width:560px;height:560px;opacity:0}}

    /* ---------- text ---------- */
    .main-text{font-size:5.2rem;font-weight:900;background:linear-gradient(45deg,#ff1493,#ff69b4,#ffc0cb);background-size:300% 300%;-webkit-background-clip:text;color:transparent;animation:gradientFlow 4s ease infinite, textPulse 1.2s ease-in-out infinite;letter-spacing:8px;text-shadow:0 0 26px rgba(255,20,147,.35)}
    @keyframes gradientFlow{0%,100%{background-position:0% 50%}50%{background-position:100% 50%}}
    @keyframes textPulse{0%,100%{transform:scale(1)}14%{transform:scale(1.12)}42%{transform:scale(1.12)}}

    .sub-text{font-size:1.6rem;color:rgba(255,255,255,.95);text-shadow:0 0 20px rgba(255,105,180,.3);margin-top:6px}

    /* ---------- music player (center) ---------- */
    .music-player{position:fixed;left:50%;bottom:20px;transform:translateX(-50%);z-index:120;display:flex;align-items:center;gap:12px;background:linear-gradient(180deg, rgba(0,0,0,.65), rgba(0,0,0,.5));padding:10px 14px;border-radius:16px;border:1px solid rgba(255,105,180,.18);backdrop-filter:blur(8px);box-shadow:0 6px 30px rgba(255,20,147,.12)}
    .control-btn{width:56px;height:56px;border-radius:50%;border:none;background:linear-gradient(135deg,#ff6aa9,#ff3b8b);color:#fff;font-size:20px;display:inline-flex;align-items:center;justify-content:center;cursor:pointer;box-shadow:0 6px 24px rgba(255,20,147,.18);transition:transform .18s ease}
    .control-btn:active{transform:scale(.95)}
    .control-btn[disabled]{opacity:.4;cursor:not-allowed}
    .volume-slider{width:120px;accent-color:#ff1493}

    /* tiny ring effect on play */
    .btn-ring{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:70px;height:70px;border-radius:50%;pointer-events:none;opacity:0}
    .btn-ring.show{animation:btnPulse .8s ease-out forwards}
    @keyframes btnPulse{0%{opacity:1;transform:translate(-50%,-50%) scale(1)}100%{opacity:0;transform:translate(-50%,-50%) scale(1.8)}}

    /* ---------- heart trail (cursor) ---------- */
    .heart-trail{position:fixed;pointer-events:none;z-index:200;will-change:transform,opacity}
    .heart-trail .h{font-size:18px;display:block;transform:translate(-50%,-50%);opacity:0;animation:trailFade 900ms linear forwards}
    @keyframes trailFade{0%{opacity:1;transform:translate(-50%,-50%) scale(.9);filter:blur(0)}100%{opacity:0;transform:translate(-50%,-150%) scale(1.6);filter:blur(0.5px)}}

    /* ---------- floating bucin hearts/petals ---------- */
    .floating-heart{position:fixed;z-index:50;pointer-events:none;font-size:28px;opacity:0;animation:floatUp linear forwards}
    @keyframes floatUp{0%{transform:translateY(0) rotate(0) scale(.7);opacity:0}10%{opacity:1}90%{opacity:1}100%{transform:translateY(-110vh) rotate(540deg) scale(1.6);opacity:0}}

    /* ---------- confetti burst hearts ---------- */
    .confetti-heart{position:fixed;z-index:300;pointer-events:none;font-size:18px;transform:translate(-50%,-50%)}
    .confetti-heart.animate{animation:confettiFly 1200ms cubic-bezier(.2,.8,.2,1) forwards}
    @keyframes confettiFly{
      0%{opacity:1;transform:translate(-50%,-50%) translateY(0) scale(1)}
      60%{transform:translate(-50%,-50%) translateY(-200px) translateX(60px) rotate(90deg) scale(.9)}
      100%{opacity:0;transform:translate(-50%,-50%) translateY(-450px) translateX(140px) rotate(360deg) scale(.6)}
    }

    /* ---------- "playing" styles (when music on) ---------- */
    body.playing .bg-gradient{filter:blur(6px) saturate(1.15)}
    body.playing .main-heart{filter:drop-shadow(0 0 80px rgba(255,20,147,1)) drop-shadow(0 0 120px rgba(255,105,180,.9));animation-duration:1s}
    body.playing .main-text{filter:drop-shadow(0 0 36px rgba(255,20,147,.45))}
    body.playing .energy-ring{animation-duration:1.6s}

    /* ---------- responsive ---------- */
    @media (max-width:480px){
      .main-text{font-size:2.6rem}
      .music-player{left:50%;bottom:14px;padding:8px 10px}
      .control-btn{width:48px;height:48px}
    }
  </style>
</head>
<body>
  <div class="bg-gradient"></div>
  <div class="light-ray"></div>

  <div class="container" aria-live="polite">
    <div class="heart-container" aria-hidden="true">
      <div class="energy-ring"></div>
      <div class="energy-ring r2"></div>
      <div class="energy-ring r3"></div>
      <div class="energy-ring r4"></div>

      <div class="heart-3d">
        <div class="main-heart"></div>
      </div>
    </div>

    <div class="text-container">
      <div class="main-text">LOVE</div>
      <div class="sub-text">Forever &amp; Always</div>
    </div>
  </div>

  <!-- Music player -->
  <div class="music-player" role="region" aria-label="Music player">
    <div style="position:relative">
      <button id="playBtn" class="control-btn" aria-pressed="false" aria-label="Play (klik untuk memutar)"><span id="playIcon">‚ñ∂Ô∏è</span></button>
      <div id="btnRing" class="btn-ring" aria-hidden="true"></div>
    </div>
    <div style="display:flex;align-items:center;gap:8px;color:#fff">
      <span aria-hidden="true">üîä</span>
      <input id="volumeSlider" class="volume-slider" type="range" min="0" max="100" value="50" aria-label="Volume" disabled>
    </div>
    <div style="color:#fff;font-weight:600;margin-left:8px" id="trackLabel">DJ ‚Äî Mengapa Mudahnya Hatimu Mendua</div>
  </div>

  <!-- youtube placeholder (empty until user interacts) -->
  <div id="youtubeHolder" style="display:none"></div>

  <!-- containers for dynamic animated elements -->
  <div id="trailRoot" aria-hidden="true"></div>
  <div id="floatingRoot" aria-hidden="true"></div>
  <div id="confettiRoot" aria-hidden="true"></div>

  <script>
    /* ---------------- CONFIG ---------------- */
    const VIDEO_ID = 'IUKzF3YFmvM';
    let YTplayer = null;
    let playerReady = false;
    let createRequested = false;
    let pendingPlay = false;

    const playBtn = document.getElementById('playBtn');
    const playIcon = document.getElementById('playIcon');
    const volSlider = document.getElementById('volumeSlider');
    const btnRing = document.getElementById('btnRing');
    const trackLabel = document.getElementById('trackLabel');

    // ---------- Lazy-load YouTube API when needed ----------
    function loadYouTubeAPI(){
      return new Promise((resolve,reject)=>{
        if(window.YT && window.YT.Player) return resolve(window.YT);
        if(document.getElementById('yt-api')) return resolve(); // already loading
        const tag=document.createElement('script');
        tag.id='yt-api';
        tag.src='https://www.youtube.com/iframe_api';
        tag.async=true;
        tag.onload = ()=> resolve(window.YT);
        tag.onerror = ()=> reject(new Error('Gagal memuat YouTube API'));
        document.head.appendChild(tag);
      });
    }

    // required global callback for YT
    window.onYouTubeIframeAPIReady = function(){
      if(createRequested){
        createPlayer(pendingPlay);
      }
    };

    function createPlayer(autoplay=false){
      if(YTplayer) return;
      createRequested = true;
      pendingPlay = !!autoplay;

      try {
        YTplayer = new YT.Player('youtubePlayer', {
          height: '0', width: '0', videoId: VIDEO_ID,
          playerVars: {autoplay: autoplay?1:0,loop:1,playlist:VIDEO_ID,origin:location.origin||window.location.href},
          events: {
            onReady: (e)=> {
              playerReady = true;
              volSlider.disabled = false;
              try { YTplayer.setVolume(parseInt(volSlider.value,10)); } catch(e){}
              if(pendingPlay){
                try{ YTplayer.playVideo(); } catch(e){}
                pendingPlay = false;
                document.body.classList.add('playing');
                playIcon.textContent = '‚è∏Ô∏è';
                playBtn.setAttribute('aria-pressed','true');
              }
            },
            onStateChange: (ev)=>{
              if(ev.data === YT.PlayerState.PLAYING){
                document.body.classList.add('playing');
                playIcon.textContent = '‚è∏Ô∏è';
                playBtn.setAttribute('aria-pressed','true');
              } else if(ev.data === YT.PlayerState.PAUSED || ev.data === YT.PlayerState.ENDED){
                document.body.classList.remove('playing');
                playIcon.textContent = '‚ñ∂Ô∏è';
                playBtn.setAttribute('aria-pressed','false');
              }
            }
          }
        });
      } catch(err){
        console.error('createPlayer err',err);
      }
    }

    async function togglePlay(){
      playBtn.disabled = true;
      // small visual ring
      btnRing.classList.remove('show');
      void btnRing.offsetWidth;
      btnRing.classList.add('show');

      try {
        if(!YTplayer){
          // create and autoplay
          await loadYouTubeAPI();
          // create visible hidden iframe container
          const holder = document.getElementById('youtubeHolder');
          holder.innerHTML = '<div id="youtubePlayer"></div>';
          createPlayer(true);
          // create confetti burst
          confettiBurstAt(playBtn);
        } else {
          const state = YTplayer.getPlayerState ? YTplayer.getPlayerState() : -1;
          if(state === YT.PlayerState.PLAYING){
            YTplayer.pauseVideo();
            // stop vibes
          } else {
            YTplayer.playVideo();
            confettiBurstAt(playBtn);
          }
        }
      } catch(err){
        console.error('togglePlay error',err);
        alert('Gagal memutar. Coba lagi.');
      } finally {
        playBtn.disabled = false;
      }
    }

    playBtn.addEventListener('click', ()=> togglePlay());
    playBtn.addEventListener('keydown', (e)=> { if(e.key === ' ' || e.key === 'Enter'){ e.preventDefault(); togglePlay(); } });

    // volume slider control
    volSlider.addEventListener('input', (e)=>{
      const v = parseInt(e.target.value,10);
      if(YTplayer && YTplayer.setVolume) try{ YTplayer.setVolume(v); }catch(_){}
    });

    // ---------- heart trail on pointer move ----------
    const trailRoot = document.getElementById('trailRoot');
    let trailAllowed = true;
    function spawnTrail(x,y){
      if(!trailAllowed) return;
      const el = document.createElement('div');
      el.className = 'heart-trail';
      el.style.left = (x)+'px';
      el.style.top = (y)+'px';
      const h = document.createElement('div');
      h.className = 'h';
      const emojis = ['üíñ','üíò','üíó','üíì','üíï','üíù'];
      h.textContent = emojis[Math.floor(Math.random()*emojis.length)];
      // random color shade
      h.style.color = 'hsl('+ (320 + Math.random()*40) + 'deg,80%,65%)';
      h.style.fontSize = (12 + Math.random()*18) + 'px';
      el.appendChild(h);
      trailRoot.appendChild(el);
      // remove after animation
      setTimeout(()=> el.remove(),900);
    }

    // mouse & touch handlers
    let lastMove = 0;
    window.addEventListener('pointermove', (e)=>{
      const now = Date.now();
      if(now - lastMove > 40){ // throttle
        spawnTrail(e.clientX, e.clientY);
        lastMove = now;
      }
    }, {passive:true});

    window.addEventListener('touchmove', (e)=>{
      const t = e.touches[0];
      if(t) spawnTrail(t.clientX, t.clientY);
    }, {passive:true});

    // ---------- floating hearts generator ----------
    const floatingRoot = document.getElementById('floatingRoot');
    function createFloatingHeart(){
      const el = document.createElement('div');
      el.className = 'floating-heart';
      const emojis = ['üíû','üíñ','üíó','üíò','üíï'];
      el.textContent = emojis[Math.floor(Math.random()*emojis.length)];
      el.style.left = (Math.random()*90 + 5) + '%';
      el.style.bottom = '-10vh';
      el.style.fontSize = (18 + Math.random()*30) + 'px';
      el.style.animationDuration = (8 + Math.random()*8) + 's';
      floatingRoot.appendChild(el);
      setTimeout(()=> el.remove(), 14000);
    }
    // spawn slowly
    setInterval(createFloatingHeart, 700);

    // ---------- confetti burst (hearts) ----------
    const confettiRoot = document.getElementById('confettiRoot');
    function confettiBurstAt(elRef){
      if(!elRef) return;
      const rect = elRef.getBoundingClientRect();
      const cx = rect.left + rect.width/2;
      const cy = rect.top + rect.height/2;
      const count = 18;
      for(let i=0;i<count;i++){
        const ch = document.createElement('div');
        ch.className = 'confetti-heart';
        ch.textContent = ['üíñ','üíò','üíó','üíì','üíï'][Math.floor(Math.random()*5)];
        ch.style.left = (cx + (Math.random()*40-20)) + 'px';
        ch.style.top = (cy + (Math.random()*40-20)) + 'px';
        confettiRoot.appendChild(ch);
        // stagger CSS transform via short timeout
        setTimeout(()=> ch.classList.add('animate'), 10 + i*12);
        setTimeout(()=> ch.remove(), 1600 + i*20);
      }
    }

    // ---------- small accessibility & performance ----------
    // prefer-reduced-motion respect
    const mq = window.matchMedia('(prefers-reduced-motion: reduce)');
    if(mq.matches){
      // disable some animations
      document.querySelectorAll('.energy-ring').forEach(el => el.style.animation = 'none');
      document.querySelectorAll('.floating-heart').forEach(el => el.style.animation = 'none');
      trailAllowed = false;
    }

    // ---------- prewarm YT API in background (optional, privacy-minded) ----------
    // We choose NOT to load API automatically to respect privacy; it will load after first click.
    // If you prefer faster first-play, uncomment loadYouTubeAPI() below:
    // loadYouTubeAPI().catch(()=>{/*ignore*/});

    // ---------- ensure youtube placeholder exists when API loaded ----------
    // We create #youtubePlayer dynamically inside createPlayer; but some browsers need container present:
    // create a hidden container
    const holder = document.getElementById('youtubeHolder');
    holder.style.display = 'none';

    // ---------- small UX: start muted preview pulse (optional) ----------
    // Add tiny heartbeat glow hint for user to click
    (function addClickHint(){
      const hint = document.createElement('div');
      hint.style.position = 'fixed';
      hint.style.left = '50%';
      hint.style.bottom = '100px';
      hint.style.transform = 'translateX(-50%)';
      hint.style.zIndex = '110';
      hint.style.color = 'rgba(255,255,255,.85)';
      hint.style.fontSize = '14px';
      hint.style.padding = '6px 10px';
      hint.style.borderRadius = '999px';
      hint.style.background = 'rgba(0,0,0,.25)';
      hint.style.backdropFilter = 'blur(4px)';
      hint.textContent = 'Klik ‚ñ∂Ô∏è untuk bernyanyi bareng ‚ô´';
      hint.id = 'clickHint';
      document.body.appendChild(hint);
      // disappear on interaction
      function removeHint(){
        hint.style.transition = 'opacity .6s';
        hint.style.opacity = '0';
        setTimeout(()=> hint.remove(),700);
        window.removeEventListener('click', removeHint);
      }
      window.addEventListener('click', removeHint, {once:true});
    })();

    // ---------- Expose functions for debugging if needed ----------
    window._confettiBurstAt = confettiBurstAt;
    window._spawnTrail = spawnTrail;

  </script>
</body>
</html>
